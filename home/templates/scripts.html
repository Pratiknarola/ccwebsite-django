{% load static %}
{% load notifications_tags %}
<!--  Scripts-->
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="{% static "Materialize/js/materialize.js" %}"></script>
<script src="{% static "Materialize/js/init.js" %}"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script
  src="http://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

{#Cropper JS files#}
{#<script src="{% static 'js_for_cropper/jquery.min.js' %}"></script>#}
{#<script src="{% static 'js_for_cropper/cropper.min.js' %}"></script>#}
{#<script src="{% static 'js_for_cropper/jquery-cropper.min.js' %}"></script>#}

{#Bootstrap JS files#}
{#<script src="{% static 'Bootstrap/js/bootstrap.min.js' %}"></script>#}
{#<script src="{% static 'Bootstrap/js/bootstrap.js' %}"></script>#}


<script>
    // Function to calculate "TIMESINCE" a date.
    function timeSince(date) {

        var seconds = Math.floor((new Date() - date) / 1000);

        var interval = Math.floor(seconds / 31536000);

        if (interval > 1) {
            return interval + " years";
        }
        interval = Math.floor(seconds / 2592000);
        if (interval > 1) {
            return interval + " months";
        }
        interval = Math.floor(seconds / 86400);
        if (interval > 1) {
            return interval + " days";
        }
        interval = Math.floor(seconds / 3600);
        if (interval > 1) {
            return interval + " hours";
        }
        interval = Math.floor(seconds / 60);
        if (interval > 1) {
            return interval + " minutes";
        }
        return Math.floor(seconds) + " seconds";
}
</script>



{# DJANGO NOTIFICATIONS HQ #}

<script>
     function my_special_notification_callback(data) {
    // for (var i=0; i < data.unread_list.length; i++) {
    //     msg = data.unread_list[i];
    //     console.log(msg.actor);
    // }
     {#console.log(data);#}

         var menus = document.getElementsByClassName(notify_menu_class);
        if (menus) {
            var messages = data.unread_list.map(function (item) {
                var message = "";
                if(typeof item.actor !== 'undefined'){
                    message = '<a class="chip">' + item.actor + '</a> ';
                }
                if(typeof item.verb !== 'undefined'){
                    message = message + " " + item.verb + '<br>';
                }
                {#if(typeof item.target !== 'undefined'){#}
                {#    message = message + " " + item.target;#}
                {# }#}
                {#if(typeof item.timestamp !== 'undefined'){#}
                {#    message = message + " " + item.timestamp;#}
                {# }#}
                {#console.log(message);#}
                return '<li class="collection-item amber">' + message + '</li>';
            }).join('');

            for (var i = 0; i < menus.length; i++){
                menus[i].innerHTML = messages;
             }
        }
 }
</script>
<script src="{% static 'notifications/notify.js' %}" type="text/javascript"></script>
{% register_notify_callbacks callbacks='my_special_notification_callback, fill_notification_badge' %}
{#{% register_notify_callbacks callbacks='fill_notification_list, fill_notification_badge' %}#}

{# DJANGO NOTIFICATIONS HQ #}


<script src="{% static 'js/main.js' %}"></script>




<script>M.AutoInit();</script>

{# Show password #}
<script>
    function showPassword() {
        var x = document.getElementById("login_password");
        if (x.type === "password") {
            x.type = "text";
        } else {
            x.type = "password";
        }
    }
</script>
{# Show password ended #}


{# For Toasts #}
    {% if messages %}
        {% for message in messages %}
            <script>M.toast({html: "{{ message }}", classes: 'rounded', displayLength: 3000})</script>
        {% endfor %}
    {% endif %}

    {% if comment_form.errors %}
        {% for field in comment_form %}
            {% for error in field.errors %}
                <script>M.toast({html: "{{ error }}", classes: 'rounded', displayLength: 3000})</script>
            {% endfor %}
        {% endfor %}
    {% endif %}

    {% if form.errors %}
        {% for field in form %}
            {% for error in field.errors %}
                <script>M.toast({html: "{{ error }}", classes: 'rounded', displayLength: 3000})</script>
            {% endfor %}
        {% endfor %}
    {% endif %}

    {% if password_change_form.errors %}
        {% for field in password_change_form %}
            {% for error in field.errors %}
                <script>M.toast({html: "{{ error }}", classes: 'rounded', displayLength: 3000})</script>
            {% endfor %}
        {% endfor %}
    {% endif %}
{# Function to display toast from HTML (when message can't be passed from view) #}
    <script>
        function addToast(message){
            M.toast({html: message, classes: 'rounded', displayLength: 3000});
        }
    </script>

